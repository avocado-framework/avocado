os: linux
dist: focal
language: python
cache: pip
arch:
  - s390x
  - ppc64le
  - arm64

python:
    - "3.9"

env:
    - AVOCADO_PARALLEL_LINT_JOBS=1

addons:
  apt:
    packages:
    - enchant
    - hunspell-en-us
    - golang

install:
    - pip install -r requirements-selftests.txt

script:
    - python -c "import multiprocessing; print(multiprocessing.cpu_count())"
    - python3 setup.py lint
    - python3 setup.py develop --user
    - python3 selftests/check.py --disable-static-checks --disable-selftests-functional
    - python3 selftests/check.py --disable-static-checks --disable-selftests-jobs --disable-selftests-unit --disable-selftests-nrunner --disable-selftests-optional-plugins --half-cpus
